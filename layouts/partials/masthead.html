<header class="u-text-center o-layout o-layout--extended o-layout--padded">
  {{- if and (eq .Type "posts") (ne .Kind "section") -}}
    {{ partial "meta.html" . }}
  {{- end -}}
  <h1 class="c-masthead__title u-mt-m" itemprop="name headline">
    {{- .Title -}}
  </h1>
  {{ $img := (.Resources.ByType "image").GetMatch "*featured*" }}
  {{ with $img }}
    {{ $mobile := .Fill "400x182"}}
    {{ $mobileRetina := .Fill "800x364" }}
    {{ $tablet := .Fill "640x292"}}
    {{ $tabletRetina := .Fill "1280x584" }}
    {{ $desktop := .Fill "900x410"}}
    {{ $desktopRetina := .Fill "1800x820" }}
    {{ if $.Params.caption }}
      <figure class="u-mb">
    {{ end}}
      <picture class="c-masthead__image u-mb" itemprop="image" itemscope itemtype="http://schema.org/ImageObject">
        <source media="(max-width: 46.25em)" srcset="{{ $mobile.RelPermalink }} 1x, {{ $mobileRetina.RelPermalink }} 2x" />
        <source media="(min-width: 46.25em)" srcset="{{ $tablet.RelPermalink }} 1x, {{ $tabletRetina.RelPermalink }} 2x" />
        <source media="(min-width: 61.25em)" srcset="{{ $desktop.RelPermalink }} 1x, {{ $desktopRetina.RelPermalink }} 2x" />
        <img src="{{ $desktop.RelPermalink }}" itemprop="contentUrl url" alt="{{ $.Params.imageAltText }}" />
      </picture>
    {{ with $.Params.caption }}
      <figcaption>{{ . | markdownify }}</figcaption>
    {{ end }}
    {{ if $.Params.caption }}
      </figure>
    {{ end}}
  {{ end }}
  {{ if not $img }}
    {{ if and (eq .Type "posts") (ne .Kind "section") }}
      <div class="c-masthead__hr"></div>
    {{ end }}
  {{ end }}
</header>
