{{ $related := .Site.RegularPages.Related . | first 3 }}
{{ $posts := where (where $.Site.RegularPages "Section" "posts") ".Params.title" "!=" .Title }}
{{ $posts := $posts | complement $related }}

<aside class="mt-24">
  <header class="mb-8">
    <h2>Keep Reading</h2>
  </header>
  {{ with $related }}
    <div class="mb-8">
      {{ partial "summary-list" (dict "posts" . "level" "h3") }}
    </div>
    <div class="hidden mt-12 sm:mt-16 js-all">
      {{ partial "summary-list" (dict "posts" $posts "level" "h3") }}
    </div>
  {{ else }}
    <div class="mb-8">
      {{ partial "summary-list" (dict "posts" (first 2 $posts) "level" "h3") }}
    </div>
    <div class="hidden mt-12 sm:mt-16 js-all">
      {{ partial "summary-list" (dict "posts" (after 2 $posts) "level" "h3") }}
    </div>
  {{ end }}
  <a href="/" class="js-view-all o-styled-link text-xs">View all posts</a>
</aside>
